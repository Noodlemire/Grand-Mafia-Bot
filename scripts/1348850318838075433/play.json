{"userexec":true,"lines":["!var me {!num}","!if {me} = None","!throw You are not a registered player!","!else {#} = 0","!throw Usage: !e play <card> [on target 1, target 2, target N...]","!else {!tag {me} hand#} <= 0","!throw You have no cards to play.","!else {!exists action_log} = False","!throw An Action Log channel must be set up first!","!else {!is {me} must_discard} = True","!throw You must discard/fuse {!tag {me} must_discard} cards first!","!end","!var cdata {1}","!var tcount 0","!for i 2 {#}","!if {on} = found","!if {!exists tdata} = True","!var tdata {tdata} {{i}}","!else","!var tdata {{i}}","!end","!else {{i}} = on","!var on found","!else","!var cdata {cdata} {{i}}","!end","!end","!var card {!e to_id {cdata}}","!var category {!e card_category {card}}","!if {!exists tdata} = True","!foreach i t {!split , {tdata}}","!var tcount {i}","!if {category} = Attack","!var t{i} {!player {t}}","!if {!tag {t{i}} hp} <= 0","!throw Player '{t}' is already dead!","!end","!else {category} = Defense","!var t{i} {!lower {t}}","!if {round_{t{i}}} != {round}","!throw Cannot find action '{t{i}}' from this round.","!else {!e card_category {card_{t{i}}}} != Attack","!throw That is not an attack, so you cannot defend against it.","!else {target_{t{i}}} != {me}","!throw You cannot block an attack against another player.","!else {!exists def_{t{i}}} = True","!throw You have already defended against this attack.","!end","!end","!if {already{t{i}}} = y","!throw Duplicate target!","!else","!var already{t{i}} y","!end","!end","!end","!var tgoal {!e targets {card}}","!for i 1 {!tag {me} hand#}","!if {!tag {me} hand{i}} = {card}","!var found true","!var i {!tag {me} hand#}","!end","!end","!if {found} != true","!throw Your hand does not have {!e to_str {card}}","!else {tcount} != {tgoal}","!var err Usage: !e play {cdata}","!if {tgoal} = 1","!var err {err} on <target>","!else","!var err {err} on","!for i 1 {tgoal}","!var err {err} <target {i}>","!if {i} < {tgoal}","!var err {err},","!end","!end","!end","!throw {err}","!end","!if {tgoal} = 0","!var tcount 1","!var t1 {me}","!end","!var ammo {!e ammo {card}}","!if {!tag {me} ammo} < {ammo}","!throw You must have at least {ammo} Ammo to use this card.","!end","!if {!exists round} = False","!g round 1","!end","!var rid round_{round}_","!if {!exists {rid}#} = False","!g {rid}# 0","!end","!for i 1 {tcount}","!var aid {!e action_id}","!g next {!add {{rid}#} 1}","!g {rid}# {next}","!g {rid}{next} {aid}","!g round_{aid} {round}","!g action_{aid} {next}","!g user_{aid} {me}","!g card_{aid} {card}","!g target_{aid} {t{i}}","!if {category} = Attack","!send {action_log} **<@{!tag {t{i}} id}>** has been attacked! They have until the end of the phase to defend. [{aid}]","!else {category} = Defense","!g def_{t{i}} = t","!send {action_log} **<@{!tag {me} id}>** defends against the '{t{i}}' attack. [{aid}]","!end","!end","!var on_play {!e card_on_play {card}}","!if {on_play} != ,","!var ops {on_play}","!foreach i op {!split , {ops}}","!var response {!e {op} {me} {t{i}} {!e card_alt_amt {card}} {i} {card}}","!if {response} != Nothing","!say {response}","!end","!end","!end","!e lose_card {me} false {card}","!tag {me} ammo {!sub {!tag {me} ammo} {ammo}}","!emsg {!tag {me} handlink} {!e hand {me}}","!overwrite"]}
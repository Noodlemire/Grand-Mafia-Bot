{"userexec":true,"lines":["!var me {!num}","!var usage Usage: !e fuse <card name> and <card name> OR !e fuse <fused card name>","!if {me} = None","!throw You are not a registered player!","!else {#} = 0","!throw {usage}","!else {!tag {me} hand#} <= 1","!throw You don't have enough cards to fuse anything.","!end","!var args {1}","!for i 2 {#}","!var args {args} {{i}}","!end","!foreach i v {!split and {args}}","!if {i} >= 3","!throw You cannot fuse more than 3 cards together.","!end","!var id{i} {!e to_id {v}}","!end","!if {!exists id1} = {!exists id2}","!if {!at 4 {id1}} = NULL and {!at 4 {id2}} = NULL","!var fusion {!e to_id {id1} {id2}}","!else","!throw You cannot fuse cards that are already fused!","!end","!else {!at 4 {id1}} != NULL","!var fusion {id1}","!var id1 {!e to_id {!at 1 {fusion}}{!at 2 {fusion}}}","!var id2 {!e to_id {!at 3 {fusion}}{!at 4 {fusion}}}","!else","!throw {usage}","!end","!if {!data card {id1} params category} != {!data card {id2} params category}","!throw You cannot fuse cards of different categories!","!end","!for i 1 {!tag {me} hand#}","!if {found1} != true and {!tag {me} hand{i}} = {id1}","!var found1 true","!else {!tag {me} hand{i}} = {id2}","!var found2 true","!end","!if {found1} = {found2}","!var i {!tag {me} hand#}","!end","!end","!if {found1} != {found2}","!var output |","!if {found1} != true","!var output {!data card {id1} title}{output}","!end","!if {found2} != true","!var output {output}{!data card {id2} title}","!end","!throw Your hand is missing {!e commalist {output}}","!end","!e lose_card false {id1}","!e lose_card false {id2}","!tag {me} hand# {!add {!tag {me} hand#} 1}","!tag {me} hand{!tag {me} hand#} {fusion}","!say You now have: {!e to_str {fusion}}"]}